<%#
 Copyright (c) 2018, Tano Systems. All Rights Reserved.
 Anton Kikin <a.kikin@tano-systems.com>
-%>

<script type="text/javascript" src="<%=resource%>/cbi.js"></script>
<script type="text/javascript">//<![CDATA[
	XHR.poll(5, '<%=url('admin/status/mstpd/status_get')%>', null,
		function(x, json)
		{
			var inner = "";
			var mstpd_status =
				document.getElementById('mstpd-status');

			console.log(json)

			if (!json || typeof json.running == 'undefined' ||
			             typeof json.pid == 'undefined')
			{
				inner += '<p class="alert-message error">' +
					'<%:Invalid response%></p>';
			}
			else if (!json.running || !json.pid)
			{
				inner += '<p class="alert-message warning">' +
					'<%:Stopped%></p>';
			}
			else if (json.running && json.pid)
			{
				inner += '<p class="alert-message success">' +
					'<%:Running%> (PID ' + json.pid + ')</p>';
			}

			mstpd_status.innerHTML = inner;
		}
	)
//]]></script>

<div class="cbi-section-node" id="mstpd-status">
	<em><%:Collecting data...%></em>
</div>


